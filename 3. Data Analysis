-number of members and nonmembers -


SELECT 
  member_casual membership_status,
  COUNT(ride_id) num_of_riders
FROM `capstone-398715.bikeproject.cleaned_data` 
GROUP BY member_casual


- number of rides starting at each station -


SELECT 
  COUNT(ride_id) num_of_rides,
  start_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
GROUP BY start_station_name
ORDER BY num_of_rides DESC

SELECT 
  COUNT(ride_id) num_of_rides,
  start_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = "member"
GROUP BY start_station_name
ORDER BY num_of_rides DESC

SELECT 
  COUNT(ride_id) num_of_rides,
  start_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = "casual"
GROUP BY start_station_name
ORDER BY num_of_rides DESC


- number of rides ending at each station -


SELECT 
  COUNT(ride_id) num_of_rides,
  end_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = 'member'
GROUP BY end_station_name
ORDER BY num_of_rides DESC

SELECT 
  COUNT(ride_id) num_of_rides,
  end_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = 'casual'
GROUP BY end_station_name
ORDER BY num_of_rides DESC

SELECT 
  COUNT(ride_id) num_of_rides,
  end_station_name
FROM `capstone-398715.bikeproject.cleaned_data`
GROUP BY end_station_name
ORDER BY num_of_rides DESC 


- types of bikes by membership -


SELECT 
  rideable_type,
  COUNT(*) num_of_rides,
  (SELECT 
    COUNT(*) as total_rides
    FROM `capstone-398715.bikeproject.cleaned_data`
    WHERE member_casual='casual') total_rides,
  COUNT(*) * 100/
  (SELECT 
    COUNT(*) as total_rides
    FROM `capstone-398715.bikeproject.cleaned_data`
    WHERE member_casual='casual') percent
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = 'casual'
GROUP BY rideable_type
ORDER BY num_of_rides DESC

SELECT 
  rideable_type,
  COUNT(*) num_of_rides,
  (SELECT 
    COUNT(*) as total_rides
    FROM `capstone-398715.bikeproject.cleaned_data`
    WHERE member_casual='member') total_rides,
  COUNT(*) * 100/
  (SELECT 
    COUNT(*) as total_rides
    FROM `capstone-398715.bikeproject.cleaned_data`
    WHERE member_casual='member') percent
FROM `capstone-398715.bikeproject.cleaned_data`
WHERE member_casual = 'member' 
GROUP BY rideable_type
ORDER BY num_of_rides DESC


- average ride length by membership type and average ride length overall -

SELECT
  AVG(started_at - ended_at) avg_ride_length,
  (SELECT
    AVG(started_at - ended_at) 
  FROM `capstone-398715.bikeproject.cleaned_data`
  WHERE member_casual = 'member')avg_member_ride_length,
  (SELECT
    AVG(started_at - ended_at) 
  FROM `capstone-398715.bikeproject.cleaned_data`
  WHERE member_casual = 'casual')avg_nonmember_ride_length
FROM `capstone-398715.bikeproject.cleaned_data`


- average ride length by day -


